<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]} }); </script>

# 智能体评估

## 主流Benchmark

1. 工具调用能力评估：BFCL、ToolBench、API-Bank

2. 通用能力评估：GAIA(General AI Assistant)、AgentBench、WebArena

3. 多智能体协作评估：ChatEval、SOTOPIA、

4. 常用评估指标

* 准确性指标：Accuracy（准确率）、Exact Match（精确匹配）、F1 Score（F1 分数），用于衡量答案的正确性。
* 效率指标：Response Time（响应时间）、Token Usage（Token 使用量），用于衡量执行效率。
* 鲁棒性指标：Error Rate（错误率）、Failure Recovery（故障恢复），用于衡量容错能力。
* 协作指标：Communication Efficiency（通信效率）、Task Completion（任务完成度），用于衡量协作效果。

介绍俩种数据集及其评测指标

## BFCL

BFCL（Berkeley Function Calling Leaderboard）基准中的四个评估类别：

<div align='center'>
<img src="../images/c4/BFCL评估类别.png" alt="BFCL评估类别" width="400">
</div>

BFCL基准测试流程：

<div align='center'>
<img src="../images/c4/BFCL基准测试流程.png" alt="BFCL基准测试流程" width="400">
</div>

BFCL数据集结构：

```json
{
  "id": "simple_001",
  "question": "What's the weather like in Beijing today?",
  "function": [
    {
      "name": "get_weather",
      "description": "Get the current weather for a location",
      "parameters": {
        "type": "object",
        "properties": {
          "location": {
            "type": "string",
            "description": "The city name"
          }
        },
        "required": ["location"]
      }
    }
  ],
  "ground_truth": [
    {
      "name": "get_weather",
      "arguments": {
        "location": "Beijing"
      }
    }
  ]
}

```

AST（Abstract Syntax Tree Matching）匹配：

AST 匹配的核心思想是：将函数调用解析为语法树，然后比较树的结构和节点值。

$$
AST_Match(P,G)=
\begin{cases}
1 & if AST(P) \equiv AST(G) \\
0 & otherwise
\end{cases}
$$

* $P$ 预测的函数调用， $G$ 为标准答案
* $AST(x)$ 表示将函数调用解析为抽象语法树， $\equiv$ 表示语法树等价
* 语法树等价条件：
    * 函数名完全一致
    * 参数键值对集合相等
    * 每个参数值语义等价（例如 `2+3` 等价于 `5`）

评估指标：

$$
\begin{aligned}
Accuracy&=\frac{1}{N}\sum_{i=1}^{N}AST_Match(P_i,G_i) \\
Accuracy_c &= \frac{1}{\lvert D_c\rvert} \sum_{i \in D_c}AST_Match(P_i,G_i) \\ c \in \{simple,multiple&,parallel,Irrelevance\} \\
Weighted \ Accuracy&=\sum_c w_c \cdot Accuracy_c \\ \sum_c w_c &=1
\end{aligned}
$$

## GAIA

GAIA(General AI Assistant)数据集难度级别：

<div align='center'>
<img src="../images/c4/GAIA级别.png" alt="GAIA级别" width="400">
</div>

数据示例：

```
{
  "task_id": "gaia_001",
  "Question": "What is the total population of the top 3 most populous cities in California?",
  "Level": 2,
  "Final answer": "12847521",
  "file_name": "",
  "file_path": "",
  "Annotator Metadata": {
    "Steps": [
      "Search for most populous cities in California",
      "Get population data for top 3 cities",
      "Sum the populations"
    ],
    "Number of steps": 3,
    "How long did this take?": "5 minutes",
    "Tools": ["web_search", "calculator"]
  }
}
```
准精确匹配(Quasi Exact Match)：

先对答案进行归一化处理，然后进行精确匹配。

$$
QEM(A_{pred},A_{true})=
\begin{cases}
1 & if \mathcal{N}(A_{pred})=\mathcal{N}(A_{true})
0 & otherwise
\end{cases}
$$

* 预测答案 $A_{pred}$ 标准答案 $A_{true}$ 
* 归一化函数 $\mathcal{N}(\cdot)$ 根据答案类型应用不同的规则，比如移除空格、大小写归一

评估指标除了总的和各级别的Accuracy，还有难度递进下降率Drop rate、平均推理步骤数Avg Steps：

$$
Drop Rate_{level \rightarrow level+1}=\frac{Accuracy_{level}-Accuracy_{level+1}}{Accuracy_{level}} \\
Avg Steps = \frac{1}{N_{correct}}\sum_{i \in correct} steps_i
$$

## 数据生成质量评估

用LLM生成数据，并进行评分，这里不做过多介绍了。